{"version":3,"sources":["StreamlitAudioRecorder.tsx","index.tsx"],"names":["StAudioRec","mediaRecorder","audioChunks","state","isRecording","audioDataURL","render","className","onClick","toggleRecording","style","width","a","stopRecording","startRecording","navigator","mediaDevices","getUserMedia","audio","stream","MediaRecorder","addEventListener","event","push","data","audioBlob","Blob","type","URL","createObjectURL","setState","arrayBuffer","then","buffer","Streamlit","setComponentValue","arr","Uint8Array","start","console","error","stop","StreamlitComponentBase","withStreamlitConnection","setComponentReady","setFrameHeight","ReactDOM","StrictMode","document","getElementById"],"mappings":"wRA2BMA,E,4MACIC,cAAsC,K,EACtCC,YAAsB,G,EACvBC,MAAQ,CAAEC,aAAa,EAAOC,aAAc,I,EAE5CC,OAAS,WACd,IAAQF,EAAgB,EAAKD,MAArBC,YACR,OACA,8BACE,4BACEG,UAAS,iBAAYH,EAAc,YAAc,IACjDI,QAAS,EAAKC,gBACdC,MAAO,CAAEC,MAAO,QAEdP,EAAsB,SAAR,qBALlB,O,EAWIK,gB,sBAAkB,sBAAAG,EAAA,0DACA,EAAKT,MAArBC,YADgB,gBAGtB,EAAKS,gBAHiB,sCAKhB,EAAKC,iBALW,2C,EASlBA,e,sBAAiB,4BAAAF,EAAA,+EAEAG,UAAUC,aAAaC,aAAa,CAAEC,OAAO,IAF7C,OAEfC,EAFe,OAGrB,EAAKlB,cAAgB,IAAImB,cAAcD,GACvC,EAAKjB,YAAc,GAEnB,EAAKD,cAAcoB,iBAAiB,iBAAiB,SAACC,GACpD,EAAKpB,YAAYqB,KAAKD,EAAME,SAG9B,EAAKvB,cAAcoB,iBAAiB,QAAQ,WAC1C,IAAMI,EAAY,IAAIC,KAAK,EAAKxB,YAAa,CAAEyB,KAAM,cAC/CtB,EAAeuB,IAAIC,gBAAgBJ,GACzC,EAAKK,SAAS,CAAEzB,iBAEhBoB,EAAUM,cAAcC,MAAK,SAACC,GAC5BC,IAAUC,kBAAkB,CAC1BC,IAAK,IAAIC,WAAWJ,WAK1B,EAAKhC,cAAcqC,QACnB,EAAKR,SAAS,CAAE1B,aAAa,IAvBR,kDAyBrBmC,QAAQC,MAAM,4BAAd,MAzBqB,0D,EA6BjB3B,cAAgB,WAClB,EAAKZ,eAA8C,aAA7B,EAAKA,cAAcE,QAC3C,EAAKF,cAAcwC,OACnB,EAAKX,SAAS,CAAE1B,aAAa,M,yBA7DVsC,KAkEVC,cAAwB3C,GACvCkC,IAAUU,oBACVV,IAAUW,iBC3FVC,IAASxC,OACP,kBAAC,IAAMyC,WAAP,KACE,kBAAC,EAAD,OAEFC,SAASC,eAAe,W","file":"static/js/main.22b73a64.chunk.js","sourcesContent":["import {\n  Streamlit,\n  StreamlitComponentBase,\n  withStreamlitConnection,\n} from \"streamlit-component-lib\";\nimport React, { ReactNode } from \"react\";\n\ndeclare var MediaRecorder: any;\ndeclare var Blob: any;\n\ninterface MediaRecorder {\n  new (stream: MediaStream): MediaRecorder;\n  start(): void;\n  stop(): void;\n  state: 'inactive' | 'recording' | 'paused';\n  addEventListener(event: 'dataavailable' | 'stop', callback: (event: any) => void): void;\n}\n\ninterface Window {\n  MediaRecorder: typeof MediaRecorder;\n}\n\ninterface State {\n  isRecording: boolean;\n  audioDataURL: string;\n}\n\nclass StAudioRec extends StreamlitComponentBase<State> {\n  private mediaRecorder: MediaRecorder | null = null;\n  private audioChunks: Blob[] = [];\n  public state = { isRecording: false, audioDataURL: \"\" };\n\n  public render = (): ReactNode => {\n    const { isRecording } = this.state;\n    return (\n    <span>\n      <button\n        className={`button ${isRecording ? \"recording\" : \"\"}`}\n        onClick={this.toggleRecording}\n        style={{ width: \"97%\" }}\n      >\n        {!isRecording ? \"üéôÔ∏è\" : \"‚¨õ\"} {/* Use square for stop symbol */}\n      </button>\n    </span>\n    );\n  };\n\n  private toggleRecording = async () => {\n    const { isRecording } = this.state;\n    if (isRecording) {\n      this.stopRecording();\n    } else {\n      await this.startRecording();\n    }\n  };\n\n  private startRecording = async () => {\n    try {\n      const stream = await navigator.mediaDevices.getUserMedia({ audio: true });\n      this.mediaRecorder = new MediaRecorder(stream);\n      this.audioChunks = [];\n\n      this.mediaRecorder.addEventListener(\"dataavailable\", (event) => {\n        this.audioChunks.push(event.data);\n      });\n\n      this.mediaRecorder.addEventListener(\"stop\", () => {\n        const audioBlob = new Blob(this.audioChunks, { type: \"audio/wav\" });\n        const audioDataURL = URL.createObjectURL(audioBlob);\n        this.setState({ audioDataURL });\n\n        audioBlob.arrayBuffer().then((buffer) => {\n          Streamlit.setComponentValue({\n            arr: new Uint8Array(buffer),\n          });\n        });\n      });\n\n      this.mediaRecorder.start();\n      this.setState({ isRecording: true });\n    } catch (error) {\n      console.error(\"Error starting recording:\", error);\n    }\n  };\n\n  private stopRecording = () => {\n    if (this.mediaRecorder && this.mediaRecorder.state !== \"inactive\") {\n      this.mediaRecorder.stop();\n      this.setState({ isRecording: false });\n    }\n  };\n}\n\nexport default withStreamlitConnection(StAudioRec);\nStreamlit.setComponentReady();\nStreamlit.setFrameHeight();\n","import React from \"react\"\nimport ReactDOM from \"react-dom\"\nimport StAudioRec from \"./StreamlitAudioRecorder\"\n\nReactDOM.render(\n  <React.StrictMode>\n    <StAudioRec />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n)\n"],"sourceRoot":""}