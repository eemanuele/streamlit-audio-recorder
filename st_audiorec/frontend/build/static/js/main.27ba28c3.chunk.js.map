{"version":3,"sources":["StreamlitAudioRecorder.tsx","index.tsx"],"names":["StAudioRec","mediaRecorder","audioChunks","state","isRecording","audioDataURL","render","onClick","toggleRecording","a","stopRecording","startRecording","navigator","mediaDevices","getUserMedia","audio","stream","MediaRecorder","addEventListener","event","push","data","audioBlob","Blob","type","URL","createObjectURL","setState","arrayBuffer","then","buffer","Streamlit","setComponentValue","arr","Uint8Array","start","console","error","stop","StreamlitComponentBase","withStreamlitConnection","setComponentReady","setFrameHeight","ReactDOM","StrictMode","document","getElementById"],"mappings":"wRA2BMA,E,4MACIC,cAAsC,K,EACtCC,YAAsB,G,EAEvBC,MAAQ,CAAEC,aAAa,EAAOC,aAAc,I,EAE5CC,OAAS,WACd,IAAQF,EAAgB,EAAKD,MAArBC,YACR,OACE,8BACE,4BAAQG,QAAS,EAAKC,iBACnBJ,EACC,wCAEA,iD,EAOFI,gB,sBAAkB,sBAAAC,EAAA,0DACA,EAAKN,MAArBC,YADgB,gBAGtB,EAAKM,gBAHiB,sCAKhB,EAAKC,iBALW,2C,EASlBA,e,sBAAiB,4BAAAF,EAAA,+EAEAG,UAAUC,aAAaC,aAAa,CAAEC,OAAO,IAF7C,OAEfC,EAFe,OAGrB,EAAKf,cAAgB,IAAIgB,cAAcD,GACvC,EAAKd,YAAc,GAEnB,EAAKD,cAAciB,iBAAiB,iBAAiB,SAACC,GACpD,EAAKjB,YAAYkB,KAAKD,EAAME,SAG9B,EAAKpB,cAAciB,iBAAiB,QAAQ,WAC1C,IAAMI,EAAY,IAAIC,KAAK,EAAKrB,YAAa,CAAEsB,KAAM,cAC/CnB,EAAeoB,IAAIC,gBAAgBJ,GACzC,EAAKK,SAAS,CAAEtB,iBAEhBiB,EAAUM,cAAcC,MAAK,SAACC,GAC5BC,IAAUC,kBAAkB,CAC1BC,IAAK,IAAIC,WAAWJ,WAK1B,EAAK7B,cAAckC,QACnB,EAAKR,SAAS,CAAEvB,aAAa,IAvBR,kDAyBrBgC,QAAQC,MAAM,4BAAd,MAzBqB,0D,EA6BjB3B,cAAgB,WAClB,EAAKT,eAA8C,aAA7B,EAAKA,cAAcE,QAC3C,EAAKF,cAAcqC,OACnB,EAAKX,SAAS,CAAEvB,aAAa,M,yBA9DVmC,KAmEVC,cAAwBxC,GACvC+B,IAAUU,oBACVV,IAAUW,iBC5FVC,IAASrC,OACP,kBAAC,IAAMsC,WAAP,KACE,kBAAC,EAAD,OAEFC,SAASC,eAAe,W","file":"static/js/main.27ba28c3.chunk.js","sourcesContent":["import {\n  Streamlit,\n  StreamlitComponentBase,\n  withStreamlitConnection,\n} from \"streamlit-component-lib\";\nimport React, { ReactNode } from \"react\";\n\ndeclare var MediaRecorder: any;\ndeclare var Blob: any;\n\ninterface MediaRecorder {\n  new (stream: MediaStream): MediaRecorder;\n  start(): void;\n  stop(): void;\n  state: 'inactive' | 'recording' | 'paused';\n  addEventListener(event: 'dataavailable' | 'stop', callback: (event: any) => void): void;\n}\n\ninterface Window {\n  MediaRecorder: typeof MediaRecorder;\n}\n\ninterface State {\n  isRecording: boolean;\n  audioDataURL: string;\n}\n\nclass StAudioRec extends StreamlitComponentBase<State> {\n  private mediaRecorder: MediaRecorder | null = null;\n  private audioChunks: Blob[] = [];\n\n  public state = { isRecording: false, audioDataURL: \"\" };\n\n  public render = (): ReactNode => {\n    const { isRecording } = this.state;\n    return (\n      <span>\n        <button onClick={this.toggleRecording}>\n          {isRecording ? (\n            <span>&#9632;</span> // Stop symbol\n          ) : (\n            <span>&#127908;</span> // Microphone symbol\n          )}\n        </button>\n      </span>\n    );\n  };\n\n  private toggleRecording = async () => {\n    const { isRecording } = this.state;\n    if (isRecording) {\n      this.stopRecording();\n    } else {\n      await this.startRecording();\n    }\n  };\n\n  private startRecording = async () => {\n    try {\n      const stream = await navigator.mediaDevices.getUserMedia({ audio: true });\n      this.mediaRecorder = new MediaRecorder(stream);\n      this.audioChunks = [];\n\n      this.mediaRecorder.addEventListener(\"dataavailable\", (event) => {\n        this.audioChunks.push(event.data);\n      });\n\n      this.mediaRecorder.addEventListener(\"stop\", () => {\n        const audioBlob = new Blob(this.audioChunks, { type: \"audio/wav\" });\n        const audioDataURL = URL.createObjectURL(audioBlob);\n        this.setState({ audioDataURL });\n\n        audioBlob.arrayBuffer().then((buffer) => {\n          Streamlit.setComponentValue({\n            arr: new Uint8Array(buffer),\n          });\n        });\n      });\n\n      this.mediaRecorder.start();\n      this.setState({ isRecording: true });\n    } catch (error) {\n      console.error(\"Error starting recording:\", error);\n    }\n  };\n\n  private stopRecording = () => {\n    if (this.mediaRecorder && this.mediaRecorder.state !== \"inactive\") {\n      this.mediaRecorder.stop();\n      this.setState({ isRecording: false });\n    }\n  };\n}\n\nexport default withStreamlitConnection(StAudioRec);\nStreamlit.setComponentReady();\nStreamlit.setFrameHeight();\n","import React from \"react\"\nimport ReactDOM from \"react-dom\"\nimport StAudioRec from \"./StreamlitAudioRecorder\"\n\nReactDOM.render(\n  <React.StrictMode>\n    <StAudioRec />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n)\n"],"sourceRoot":""}